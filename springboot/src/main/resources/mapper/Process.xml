<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.lengs.springboot.mapper.ProcessMapper">
    <select id="listProcess" resultType="org.lengs.springboot.entity.Process">
        select * from Process where processCreateBy = #{processCreateBy}
        <if test="processID != null and processID != ''">
            and processID = #{processID}
        </if>
    </select>
    <select id="listBySubmission" resultType="org.lengs.springboot.entity.Submission">
        select * from Submission where submissionID = #{submissionID}
    </select>
    <select id="listReport" resultType="org.lengs.springboot.entity.Report">
        select * from Report
        <where>
            <if test="reportID != null and reportID != ''">
                reportID = #{reportID}
            </if>
            <if test="groupID != null and groupID != ''">
                and groupID = #{groupID}
            </if>
        </where>
    </select>
    <select id="listByProcess" resultType="org.lengs.springboot.entity.Process">
        select * from Process
        <where>
            <if test="userID != null and userID != ''">
                processCreateBy like concat('%', #{userID} , '%')
            </if>
            <if test="groupID != null and groupID != ''">
                and groupID like concat('%', #{groupID} , '%')
            </if>
        </where>;
    </select>
    <select id="listMission">
        select * from Mission
        <where>
            <if test="missionID != null and missionID != ''">
                missionID = #{missionID}
            </if>
            <if test="groupID != null and groupID != ''">
                and groupID = #{groupID}
            </if>
        </where>;
    </select>
    <select id="listMidCheck" resultType="org.lengs.springboot.entity.MidCheck">
        select * from MidCheck
        <where>
            <if test="midcheckID != null and midcheckID != ''">
                midcheckID = #{midcheckID}
            </if>
            <if test="groupID != null and groupID != ''">
                and groupID = #{groupID}
            </if>
        </where>;
    </select>
    <update id="updateSubmission">
        update Submission
        set
            <if test="submissionTeacherReview != null and submissionTeacherReview != ''">
                submissionTeacherReview = #{submissionTeacherReview}
            </if>
            <if test="submissionExpertReview != null and submissionExpertReview != ''">
                submissionExpertReview = #{submissionExpertReview}
            </if>
        where submissionID = #{submissionID};
    </update>
    <update id="updateProcess">
        update Process
        set
            <if test="processDeadTime != null and processDeadTime != ''">
                processDeadTime = #{processDeadTime},
            </if>
            <if test="processCondition != null and processCondition != ''">
                processCondition = #{processCondition},
            </if>
            <if test="reportID != null and reportID != ''">
                reportID = #{reportID},
            </if>
            <if test="missionID != null and missionID != ''">
                missionID = #{missionID},
            </if>
            <if test="midcheckID != null and midcheckID != ''">
                midcheckID = #{midcheckID},
            </if>
            <if test="oralID != null and oralID != ''">
                oralID = #{oralID},
            </if>
            <if test="processName != null and processName != ''">
                processName = #{processName}
            </if>
        where processID = #{processID};
    </update>
    <update id="updateMission">
        update Mission
        set
            <if test="missionTeacherReview != null and missionTeacherReview != ''">
                missionTeacherReview = #{missionTeacherReview}
            </if>
            <if test="missionExpertReview != null and missionExpertReview != ''">
                missionExpertReview = #{missionExpertReview}
            </if>
        where missionID = #{missionID}
    </update>
    <insert id="createProcess">
        insert into Process(processName,processCreateBy,groupID,processCreateTime,processChangeTime,processDeadTime,processCondition,submissionID)
        values (#{processName},#{processCreateBy},#{groupID},#{processCreateTime},#{processChangeTime},#{processDeadTime},#{processCondition},#{submissionID});
    </insert>
    <insert id="createSubmission" useGeneratedKeys="true" keyProperty="submissionID">
        insert into Submission(submissionBase,groupID,submissionType,submissionBrief,submissionDirection,submissionLanguage,submissionTeacherReview,submissionExpertReview)
        values (#{submissionBase},#{groupID},#{submissionType},#{submissionBrief},#{submissionDirection},#{submissionLanguage},#{submissionTeacherReview},#{submissionExpertReview})
    </insert>
    <insert id="createReport" useGeneratedKeys="true" keyProperty="reportID">
        insert into Report(groupID,reportMeaning,reportSituation,reportAim,reportWay)
        values (#{groupID},#{reportMeaning},#{reportSituation},#{reportAim},#{reportWay})
    </insert>
    <insert id="createMission" useGeneratedKeys="true" keyProperty="missionID">
        insert into Mission(groupID,missionGoal,missionContent,missionPlan,missionReferences)
        values (#{groupID},#{missionGoal},#{missionContent},#{missionPlan},#{missionReferences})
    </insert>
    <insert id="createMidCheck" useGeneratedKeys="true" keyProperty="midcheckID">
        insert into MidCheck(groupID,midcheckSummary,midcheckProblem)
        values (#{groupID},#{midcheckSummary},#{midcheckProblem})
    </insert>
</mapper>